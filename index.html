<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalaya: Cat Revenge</title>
    <style>
        :root { --gold: #FFD700; --blood: #ff0000; }
        * { box-sizing: border-box; touch-action: none; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Arial', sans-serif; }
        
        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨ */
        #hud { position: fixed; top: 15px; width: 100%; display: flex; justify-content: space-around; z-index: 1000; }
        .stat { background: rgba(0,0,0,0.85); border: 2px solid var(--gold); color: white; padding: 10px 20px; border-radius: 50px; font-weight: bold; box-shadow: 0 0 15px var(--gold); }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; display: flex; align-items: center; justify-content: center; }
        .card { background: #111; border: 3px solid var(--gold); border-radius: 30px; padding: 40px; text-align: center; color: white; width: 85%; max-width: 450px; }
        .btn { background: var(--gold); color: black; border: none; padding: 15px 50px; font-size: 24px; font-weight: bold; border-radius: 50px; cursor: pointer; margin-top: 20px; }
        
        canvas { display: block; }
    </style>
</head>
<body>

<div id="hud">
    <div class="stat">ğŸ’° <span id="coin-val">520</span></div>
    <div class="stat">ğŸ° <span id="stage-name">Ø³Ø±Ø¯Ø§Ø¨ Ø§Ù„ØºØ¨Ø§Ø±</span></div>
    <div class="stat">â¤ï¸ <span id="life-val">â¤ï¸â¤ï¸â¤ï¸</span></div>
</div>

<div id="overlay">
    <div class="card">
        <h1 style="color:var(--gold);">Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ù‚Ø·Ø· ğŸ¾</h1>
        <p id="m-desc">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø§Ø¯ÙØ¹ 10 ÙƒÙˆÙŠÙ†Ø² Ù„Ù…Ø­Ø§Ø±Ø¨Ø© Ø§Ù„ÙˆØ­ÙˆØ´!</p>
        <button class="btn" onclick="startLevel()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù‚ØµØ± ğŸ”¥</button>
    </div>
</div>

<script>
const canvas = document.createElement('canvas');
const ctx = canvas.getContext('2d');
document.body.appendChild(canvas);

// ØµÙˆØ± Ù…Ø¶Ù…ÙˆÙ†Ø© (Ø§Ù„Ù‚Ø·Ø© ÙˆØ§Ù„ÙˆØ­ÙˆØ´)
const img = {
    cat: new Image(),
    monster: new Image(),
    coin: new Image()
};
// ØµÙˆØ± Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø¸Ù‡ÙˆØ± Ø¯Ø±Ø§Ø¬Ø§Øª!
img.cat.src = 'https://img.icons8.com/plasticine/200/cat.png'; 
img.monster.src = 'https://img.icons8.com/flat-round/200/skull.png'; // ÙˆØ­Ø´ Ø¨Ø´ÙƒÙ„ Ø¬Ù…Ø¬Ù…Ø© Ù…Ø±Ø¹Ø¨Ø©
img.coin.src = 'https://img.icons8.com/color/100/coins.png';

let state = { playing: false, stage: 1, coins: 520, lives: 3, dist: 0, target: 3000 };
let player = { x: 50, y: 0, v: 0, g: 0.5, j: -10, w: 80, h: 80 };
let obs = [], gold = [];

// Ù…Ø­Ø±Ùƒ Ø£ØµÙˆØ§Øª Ù…Ø§Ø±ÙŠÙˆ
const audio = new (window.AudioContext || window.webkitAudioContext)();
function playSFX(type) {
    if(audio.state === 'suspended') audio.resume();
    const osc = audio.createOscillator();
    const g = audio.createGain();
    osc.connect(g); g.connect(audio.destination);
    if(type === 'jump') {
        osc.frequency.setValueAtTime(150, audio.currentTime);
        osc.frequency.exponentialRampToValueAtTime(600, audio.currentTime + 0.1);
        g.gain.exponentialRampToValueAtTime(0.01, audio.currentTime + 0.1);
        osc.start(); osc.stop(audio.currentTime + 0.1);
    } else if(type === 'coin') {
        osc.frequency.setValueAtTime(987, audio.currentTime);
        osc.frequency.setValueAtTime(1318, audio.currentTime + 0.08);
        g.gain.setValueAtTime(0.1, audio.currentTime);
        g.gain.exponentialRampToValueAtTime(0.01, audio.currentTime + 0.3);
        osc.start(); osc.stop(audio.currentTime + 0.3);
    }
}

function resize() {
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    player.x = canvas.width * 0.15;
}
window.onresize = resize; resize();

function startLevel() {
    state.playing = true; state.dist = 0; state.lives = 3;
    obs = []; gold = [];
    player.y = canvas.height / 2;
    document.getElementById('overlay').style.display = 'none';
    loop();
}

function loop() {
    if(!state.playing) return;
    
    // Ø®Ù„ÙÙŠØ© Ø±Ø¹Ø¨ Ø¯Ø§ÙƒÙ†Ø©
    ctx.fillStyle = '#050505'; ctx.fillRect(0,0,canvas.width, canvas.height);
    
    // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù‚Ø·Ø©
    player.v += player.g; player.y += player.v;
    if(player.y > canvas.height - player.h) player.y = canvas.height - player.h;
    if(player.y < 0) player.y = 0;
    ctx.drawImage(img.cat, player.x, player.y, player.w, player.h);

    // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙˆØ­ÙˆØ´ (ØªØ£ÙƒØ¯ Ù…Ù† Ø´ÙƒÙ„ Ø§Ù„Ø¬Ù…Ø¬Ù…Ø© Ø£Ùˆ Ø§Ù„ÙˆØ­Ø´)
    if(Math.random() < 0.02) {
        obs.push({ x: canvas.width, y: Math.random()*(canvas.height-80), s: 90 });
    }
    obs.forEach((o, i) => {
        o.x -= 7;
        ctx.drawImage(img.monster, o.x, o.y, o.s, o.s);
        if(player.x < o.x+o.s-20 && player.x+player.w > o.x+20 && player.y < o.y+o.s-20 && player.y+player.h > o.y+20) {
            state.lives--; obs.splice(i, 1);
            if(state.lives <= 0) endGame();
            updateHUD();
        }
    });

    // ÙƒÙˆÙŠÙ†Ø² Ù…Ø§Ø±ÙŠÙˆ
    if(Math.random() < 0.03) gold.push({ x: canvas.width, y: Math.random()*(canvas.height-50) });
    gold.forEach((g, i) => {
        g.x -= 5;
        ctx.drawImage(img.coin, g.x, g.y, 40, 40);
        if(Math.hypot(player.x+40-g.x, player.y+40-g.y) < 50) {
            state.coins += 10; playSFX('coin'); gold.splice(i, 1); updateHUD();
        }
    });

    requestAnimationFrame(loop);
}

function updateHUD() {
    document.getElementById('coin-val').innerText = state.coins;
    document.getElementById('life-val').innerText = "â¤ï¸".repeat(state.lives);
}

function endGame() {
    state.playing = false;
    document.getElementById('overlay').style.display = 'flex';
    document.querySelector('h1').innerText = "Ø§Ù„ØªÙ‡Ù…ØªÙƒ Ø§Ù„ÙˆØ­ÙˆØ´! ğŸ’€";
}

window.onmousedown = () => { if(state.playing) { player.v = player.j; playSFX('jump'); } };
window.ontouchstart = (e) => { e.preventDefault(); if(state.playing) { player.v = player.j; playSFX('jump'); } };
</script>
</body>
</html>