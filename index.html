<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Himalaya: Elite Tournament</title>
    <style>
        :root { --gold: #FFD700; --cyan: #00f2ff; --red: #ff3131; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Segoe UI', sans-serif; }

        /* HUD - ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ø±Ø¶ */
        #ui { position: fixed; top: 0; width: 100%; padding: 15px; z-index: 1000; display: flex; flex-direction: column; gap: 8px; }
        #top-row { display: flex; justify-content: space-between; color: var(--gold); font-weight: bold; font-size: 18px; text-shadow: 2px 2px #000; }
        .health-heart { color: var(--red); font-size: 24px; }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬ */
        #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 2000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(10px); }
        .window { background: linear-gradient(145deg, #1a1a2e, #000); padding: 25px; border-radius: 30px; border: 3px solid var(--gold); text-align: center; width: 90%; max-width: 500px; color: #fff; }
        
        .leaderboard { background: rgba(255,255,255,0.05); border-radius: 15px; margin: 15px 0; padding: 10px; font-size: 14px; }
        .rank-row { display: flex; justify-content: space-between; padding: 5px 10px; border-bottom: 1px solid #333; }
        .rank-row.highlight { color: var(--gold); font-weight: bold; background: rgba(255,215,0,0.1); }

        .btn-pay { background: var(--red); color: white; padding: 12px 30px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-start { background: var(--gold); color: #000; width: 100%; padding: 15px; border-radius: 50px; border: none; font-size: 22px; font-weight: bold; cursor: pointer; margin-top: 15px; }

        canvas { display: block; }
    </style>
</head>
<body>

<div id="ui">
    <div id="top-row">
        <div>ğŸ† Ø§Ù„ØªØ±ØªÙŠØ¨: <span id="rank-val">--</span></div>
        <div>â¤ï¸ <span id="lives-val">â¤ï¸â¤ï¸â¤ï¸</span></div>
        <div>ğŸ’° $<span id="balance-val">0</span></div>
    </div>
    <div style="width:100%; height:8px; background:rgba(255,255,255,0.1); border-radius:10px; overflow:hidden;">
        <div id="prog-fill" style="width:0%; height:100%; background:var(--gold); transition:0.1s;"></div>
    </div>
</div>

<div id="overlay">
    <div class="window">
        <h2 id="m-title" style="color:var(--gold); margin:0;">Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ù„Ù„Ù‚Ø·Ø·</h2>
        
        <div class="leaderboard">
            <div class="rank-row highlight"><span>1#</span> <span>Ø§Ù„Ù…ØªØµØ¯Ø±</span> <span>$10</span></div>
            <div class="rank-row"><span>2#</span> <span>Ø§Ù„ÙˆØµÙŠÙ</span> <span>$8</span></div>
            <div class="rank-row"><span>3#</span> <span>Ø§Ù„Ù…Ø­ØªØ±Ù</span> <span>$6</span></div>
            <div class="rank-row"><span>4#</span> <span>Ø§Ù„Ù…ØºØ§Ù…Ø±</span> <span>$4</span></div>
            <div class="rank-row"><span>5#</span> <span>Ø§Ù„Ø·Ù…ÙˆØ­</span> <span>$2</span></div>
            <div style="font-size:10px; color:#888; margin-top:5px;">Ø¨Ù‚ÙŠØ© Ø§Ù„Ù€ 15 Ø§Ù„Ø£ÙˆØ§Ø¦Ù„: $1 | Ø§Ù„Ø®Ø§Ø³Ø±ÙˆÙ† ÙŠØ¯ÙØ¹ÙˆÙ† $1</div>
        </div>

        <div id="result-box" style="display:none; background:rgba(255,49,49,0.1); padding:10px; border-radius:15px; margin-bottom:10px;">
            <p id="result-msg" style="margin:0;"></p>
        </div>

        <button class="btn-start" onclick="init()">Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠ ğŸ¾</button>
        <p style="font-size:11px; color:#aaa; margin-top:10px;">Ø¯Ø®ÙˆÙ„Ùƒ Ø§Ù„Ù„Ø¹Ø¨Ø© ÙŠØ¹Ù†ÙŠ Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ø¹Ù„Ù‰ Ø´Ø±ÙˆØ· Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²</p>
    </div>
</div>

<script>
const cvs = document.createElement('canvas');
const ctx = cvs.getContext('2d');
document.body.appendChild(cvs);

// Ø§Ù„ØµÙˆØ± (Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² ÙˆØ§Ù„Ù‚Ø·Ø©)
const imgC = new Image(); imgC.src = 'https://cdn-icons-png.flaticon.com/512/1864/1864514.png';
const imgG = new Image(); imgG.src = 'https://cdn-icons-png.flaticon.com/512/2489/2489756.png'; // Ø°Ù‡Ø¨
const imgH = new Image(); imgH.src = 'https://cdn-icons-png.flaticon.com/512/2107/2107845.png'; // Ù‚Ù„Ø¨/Ø³Ù…ÙƒØ©
const imgM = new Image(); imgM.src = 'https://cdn-icons-png.flaticon.com/512/1211/1211053.png'; // ÙˆØ­Ø´

let state = { playing: false, lives: 3, score: 0, dist: 0, frame: 0, stage: 1 };
let player = { x: 0, y: 0, v: 0, g: 0.45, j: -9, w: 70, h: 70 };
let ents = { obs: [], items: [] };

function sfx(f, t, d) {
    const au = new (window.AudioContext || window.webkitAudioContext)();
    let o = au.createOscillator(), g = au.createGain();
    o.type = t; o.frequency.setValueAtTime(f, au.currentTime);
    g.gain.exponentialRampToValueAtTime(0.01, au.currentTime + d);
    o.connect(g); g.connect(au.destination); o.start(); o.stop(au.currentTime + d);
}

function resize() {
    cvs.width = window.innerWidth; cvs.height = window.innerHeight;
    player.x = cvs.width * 0.15;
}
window.onresize = resize; resize();

function init() {
    state = { playing: true, lives: 3, score: 0, dist: 0, frame: 0, stage: 1 };
    ents = { obs: [], items: [] };
    player.y = cvs.height/2; player.v = 0;
    document.getElementById('overlay').style.display = 'none';
    sfx(200, 'square', 0.5);
    loop();
}

function loop() {
    if(!state.playing) return;
    state.frame++; state.dist += 2;
    
    // Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ØµØ±ÙŠ Ù„Ù„ÙˆØ§Ø¬Ù‡Ø©
    let target = 4000;
    document.getElementById('prog-fill').style.width = Math.min(100, (state.dist/target)*100) + '%';
    document.getElementById('lives-val').innerText = "â¤ï¸".repeat(state.lives);
    document.getElementById('balance-val').innerText = state.score;

    // Ø±Ø³Ù… Ø§Ù„Ù‚ØµØ±
    ctx.fillStyle = '#050510'; ctx.fillRect(0,0,cvs.width, cvs.height);
    
    // Ù†ÙˆØ§ÙØ° Ø§Ù„Ù‚ØµØ± (Ø¯ÙŠÙƒÙˆØ±)
    ctx.fillStyle = '#1a1a2e';
    for(let i=0; i<5; i++) {
        let x = (i * 400) - (state.dist % 400);
        ctx.fillRect(x + 100, 150, 80, 150);
    }

    // Ø§Ù„Ù„Ø§Ø¹Ø¨
    player.v += player.g; player.y += player.v;
    ctx.drawImage(imgC, player.x, player.y, player.w, player.h);

    // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± (Ø°Ù‡Ø¨ ÙˆØ¬ÙˆØ§Ø¦Ø²)
    if(state.frame % 60 == 0) {
        let type = Math.random() > 0.9 ? 'life' : 'coin';
        ents.items.push({ x: cvs.width, y: 100 + Math.random()*(cvs.height-200), type });
    }

    ents.items.forEach((it, i) => {
        it.x -= 6;
        ctx.drawImage(it.type == 'coin' ? imgG : imgH, it.x, it.y, 35, 35);
        if(Math.hypot(player.x+35-it.x, player.y+35-it.y) < 45) {
            if(it.type == 'coin') state.score += 5;
            else if(state.lives < 3) state.lives++;
            ents.items.splice(i,1); sfx(it.type=='coin'?800:1200, 'sine', 0.1);
        }
    });

    // Ø§Ù„ÙˆØ­ÙˆØ´
    if(state.frame % 70 == 0) ents.obs.push({ x: cvs.width, y: 100 + Math.random()*(cvs.height-200), s: 70 });
    ents.obs.forEach((o, i) => {
        o.x -= 8;
        ctx.drawImage(imgM, o.x, o.y, o.s, o.s);
        if(player.x+15 < o.x+o.s-15 && player.x+player.w-15 > o.x+15 && player.y+15 < o.y+o.s-15 && player.y+player.h-15 > o.y+15) {
            state.lives--; ents.obs.splice(i,1); sfx(100, 'sawtooth', 0.4);
            if(state.lives <= 0) end();
        }
    });

    if(player.y < 0 || player.y > cvs.height - 70) end();
    if(state.dist > target) end(true);

    requestAnimationFrame(loop);
}

function end(win = false) {
    state.playing = false;
    const box = document.getElementById('result-box');
    const msg = document.getElementById('result-msg');
    box.style.display = 'block';
    
    // Ù…Ø­Ø§ÙƒØ§Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±ØªÙŠØ¨ ÙˆØ§Ù„Ø¬ÙˆØ§Ø¦Ø²
    let finalRank = Math.floor(Math.random() * 50) + 1;
    document.getElementById('rank-val').innerText = finalRank;

    if(finalRank <= 5) {
        let prize = [10, 8, 6, 4, 2][finalRank-1];
        msg.innerHTML = `ğŸŒŸ Ù…Ø°Ù‡Ù„! ØªØ±ØªÙŠØ¨Ùƒ: ${finalRank}<br>Ø±Ø¨Ø­Øª Ø¬Ø§Ø¦Ø²Ø© Ù…Ø§Ù„ÙŠØ©: <b>$${prize}</b>`;
        msg.style.color = "var(--gold)";
    } else if(finalRank <= 15) {
        msg.innerHTML = `ğŸ‘ Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹! ØªØ±ØªÙŠØ¨Ùƒ: ${finalRank}<br>Ø±Ø¨Ø­Øª: <b>$1</b>`;
        msg.style.color = "#fff";
    } else {
        msg.innerHTML = `âš ï¸ Ø­Ø¸Ø§Ù‹ Ø£ÙˆÙØ±! ØªØ±ØªÙŠØ¨Ùƒ: ${finalRank}<br>Ø³ÙŠØªÙ… Ø®ØµÙ… <b>$1</b> Ù…Ù† Ø±ØµÙŠØ¯Ùƒ.`;
        msg.style.color = "var(--red)";
    }

    document.getElementById('m-title').innerText = win ? "ğŸ† ØªÙ… ØºØ²Ùˆ Ø§Ù„Ù‚ØµØ±!" : "ğŸ’€ Ø³Ù‚Ø·Øª ÙÙŠ Ø§Ù„ÙØ®!";
    document.getElementById('overlay').style.display = 'flex';
}

const jump = () => { if(state.playing) { player.v = player.j; sfx(600, 'triangle', 0.08); } };
window.addEventListener('mousedown', jump);
window.addEventListener('touchstart', (e) => { jump(); e.preventDefault(); });
</script>
</body>
</html>