<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalaya: The Royal Cat & The Shadow Beasts</title>
    <style>
        :root { --gold: #FFD700; --red: #ff0000; --bg: #050508; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: var(--bg); font-family: 'Tahoma', sans-serif; }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        #hud { position: fixed; top: 10px; width: 100%; display: flex; justify-content: space-around; z-index: 1000; pointer-events: none; }
        .badge { background: rgba(0,0,0,0.7); border: 2px solid var(--gold); color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 18px; box-shadow: 0 0 10px rgba(255,215,0,0.3); }

        /* Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(8px); }
        .panel { background: linear-gradient(145deg, #1a1a1a, #000); border: 3px solid var(--gold); border-radius: 30px; padding: 40px; text-align: center; color: white; width: 90%; max-width: 450px; box-shadow: 0 0 50px rgba(0,0,0,1); }
        .panel h1 { font-size: 32px; color: var(--gold); margin-bottom: 10px; text-shadow: 0 0 10px var(--gold); }
        .panel p { color: #ccc; margin-bottom: 25px; line-height: 1.6; }
        
        .btn-action { background: var(--gold); color: black; border: none; padding: 15px 40px; font-size: 22px; font-weight: bold; border-radius: 50px; cursor: pointer; transition: 0.3s; box-shadow: 0 5px 15px rgba(255,215,0,0.4); }
        .btn-action:hover { transform: scale(1.05); box-shadow: 0 0 25px var(--gold); }

        canvas { display: block; }
    </style>
</head>
<body>

<div id="hud">
    <div class="badge">ğŸ’° <span id="coin-count">0</span></div>
    <div class="badge">ğŸ‘¾ Ø§Ù„Ù…Ø±Ø­Ù„Ø©: <span id="stage-num">1</span></div>
    <div class="badge">â¤ï¸ <span id="life-icons">â¤ï¸â¤ï¸â¤ï¸</span></div>
</div>

<div id="overlay">
    <div class="panel">
        <h1 id="menu-title">Ø¹Ø±Ø´ Ø§Ù„Ù‚Ø·Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ©</h1>
        <p id="menu-desc">Ù‡Ù„ Ø£Ù†Øª Ù…Ø³ØªØ¹Ø¯ Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ØŸ Ø§Ø¯ÙØ¹ 10 ÙƒÙˆÙŠÙ†Ø² Ù„Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ø¨Ø­ÙŠØ§ØªÙƒ ÙˆØ¬Ù…Ø¹ Ø§Ù„ÙƒÙ†ÙˆØ².</p>
        <button class="btn-action" onclick="initGame()">Ø¯ÙØ¹ ÙˆØ¯Ø®ÙˆÙ„ Ø§Ù„Ù‚ØµØ± ğŸ¾</button>
    </div>
</div>

<script>
const cvs = document.createElement('canvas');
const ctx = cvs.getContext('2d');
document.body.appendChild(cvs);

// Ø£ØµÙˆÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© (Ø§Ù„ØµÙˆØ±)
const img = {
    cat: new Image(),
    mon: new Image(),
    coin: new Image(),
    bg: new Image()
};
img.cat.src = 'https://cdn-icons-png.flaticon.com/512/1864/1864514.png';
img.mon.src = 'https://cdn-icons-png.flaticon.com/512/1211/1211053.png'; // ÙˆØ­Ø´ Ù…Ø±Ø¹Ø¨
img.coin.src = 'https://cdn-icons-png.flaticon.com/512/2489/2489756.png';

// Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª (Mario Style)
const audio = new (window.AudioContext || window.webkitAudioContext)();
function playSound(type) {
    const osc = audio.createOscillator();
    const g = audio.createGain();
    osc.connect(g); g.connect(audio.destination);
    
    if(type === 'jump') { // Mario Jump
        osc.frequency.setValueAtTime(150, audio.currentTime);
        osc.frequency.exponentialRampToValueAtTime(600, audio.currentTime + 0.1);
        g.gain.exponentialRampToValueAtTime(0.0001, audio.currentTime + 0.1);
        osc.start(); osc.stop(audio.currentTime + 0.1);
    } else if(type === 'coin') { // Mario Coin
        osc.frequency.setValueAtTime(987, audio.currentTime);
        osc.frequency.setValueAtTime(1318, audio.currentTime + 0.08);
        g.gain.setValueAtTime(0.1, audio.currentTime);
        g.gain.exponentialRampToValueAtTime(0.0001, audio.currentTime + 0.3);
        osc.start(); osc.stop(audio.currentTime + 0.3);
    } else if(type === 'hit') { // Horror Hit
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(100, audio.currentTime);
        osc.frequency.linearRampToValueAtTime(10, audio.currentTime + 0.2);
        g.gain.fadeOut = 0.2;
        osc.start(); osc.stop(audio.currentTime + 0.2);
    }
}

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆØ§Ù„Ù…Ø±Ø§Ø­Ù„
let state = { playing: false, stage: 1, score: 0, lives: 3, distance: 0, target: 4000 };
let player = { x: 0, y: 0, v: 0, g: 0.5, j: -9, w: 75, h: 75 };
let obs = [], gold = [];

function resize() {
    cvs.width = window.innerWidth; cvs.height = window.innerHeight;
    player.x = cvs.width * 0.15;
}
window.onresize = resize; resize();

function initGame() {
    state.playing = true;
    state.distance = 0;
    state.lives = 3;
    obs = []; gold = [];
    player.y = cvs.height / 2;
    document.getElementById('overlay').style.display = 'none';
    audio.resume();
    animate();
}

function animate() {
    if(!state.playing) return;
    
    // Ø®Ù„ÙÙŠØ© "Ø§Ù„Ø¯Ù‡Ù„ÙŠØ²"
    ctx.fillStyle = '#050508'; ctx.fillRect(0,0,cvs.width, cvs.height);
    
    // Ø±Ø³Ù… ØªØ£Ø«ÙŠØ±Ø§Øª Ø¶ÙˆØ¦ÙŠØ© Ø®ÙÙŠÙØ©
    let grd = ctx.createRadialGradient(player.x+37, player.y+37, 20, player.x+37, player.y+37, 200);
    grd.addColorStop(0, 'rgba(255,215,0,0.15)');
    grd.addColorStop(1, 'transparent');
    ctx.fillStyle = grd; ctx.fillRect(0,0,cvs.width, cvs.height);

    // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù‚Ø·Ø©
    player.v += player.g; player.y += player.v;
    if(player.y > cvs.height - player.h) player.y = cvs.height - player.h;
    if(player.y < 0) player.y = 0;
    ctx.drawImage(img.cat, player.x, player.y, player.w, player.h);

    // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§ÙØ© ÙˆØ§Ù„Ù…Ø±Ø§Ø­Ù„
    state.distance += (4 + state.stage);
    
    // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙˆØ­ÙˆØ´ (ØªØ²Ø¯Ø§Ø¯ Ø°ÙƒØ§Ø¡Ù‹ ÙˆØ³Ø±Ø¹Ø© Ù…Ø¹ Ø§Ù„Ù…Ø±Ø­Ù„Ø©)
    if(Math.random() < 0.015 + (state.stage * 0.005)) {
        obs.push({ x: cvs.width, y: Math.random()*(cvs.height-80), s: 85 + (state.stage * 5) });
    }
    obs.forEach((o, i) => {
        o.x -= (6 + state.stage);
        // Ø§Ù„ÙˆØ­Ø´ ÙŠÙ„Ø§Ø­Ù‚ Ø§Ù„Ù‚Ø·Ø© Ù‚Ù„ÙŠÙ„Ø§Ù‹ (Ø°ÙƒØ§Ø¡ Ø¨Ø³ÙŠØ·)
        if(o.x < cvs.width/2 && o.y < player.y) o.y += 0.5;
        if(o.x < cvs.width/2 && o.y > player.y) o.y -= 0.5;
        
        ctx.drawImage(img.mon, o.x, o.y, o.s, o.s);
        
        if(player.x < o.x + o.s - 25 && player.x + player.w > o.x + 25 &&
           player.y < o.y + o.s - 25 && player.y + player.h > o.y + 25) {
            state.lives--;
            playSound('hit');
            obs.splice(i, 1);
            if(state.lives <= 0) endGame("Ø³Ø­Ù‚Ùƒ Ø§Ù„ÙˆØ­Ø´! ğŸ’€");
        }
    });

    // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø°Ù‡Ø¨
    if(Math.random() < 0.03) gold.push({ x: cvs.width, y: Math.random()*(cvs.height-50) });
    gold.forEach((g, i) => {
        g.x -= 5;
        ctx.drawImage(img.coin, g.x, g.y, 45, 45);
        if(Math.hypot(player.x+37-g.x, player.y+37-g.y) < 50) {
            state.score += 10;
            playSound('coin');
            gold.splice(i, 1);
            document.getElementById('coin-count').innerText = state.score;
        }
    });

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    document.getElementById('life-icons').innerText = "â¤ï¸".repeat(state.lives);
    document.getElementById('stage-num').innerText = state.stage;

    // ÙØ­Øµ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø±Ø­Ù„Ø©
    if(state.distance >= state.target) {
        endGame("Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰");
        state.stage++;
        state.target += 2000; // Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø£Ø·ÙˆÙ„
    } else {
        requestAnimationFrame(animate);
    }
}

function endGame(msg) {
    state.playing = false;
    document.getElementById('overlay').style.display = 'flex';
    document.getElementById('menu-title').innerText = msg;
    document.getElementById('menu-desc').innerText = `Ù†Ù‚Ø§Ø·Ùƒ: ${state.score} | Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©: ${state.stage}`;
    document.querySelector('.btn-action').innerText = "Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸";
}

// Ø§Ù„ØªØ­ÙƒÙ…
const act = () => { if(state.playing) { player.v = player.j; playSound('jump'); } };
window.onmousedown = act;
window.ontouchstart = (e) => { e.preventDefault(); act(); };

</script>
</body>
</html>