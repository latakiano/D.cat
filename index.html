<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalaya: The Royal Nightmare</title>
    <style>
        :root { --gold: #FFD700; --blood: #880000; --ghost: #e0e0e0; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #050000; font-family: 'Amiri', serif; }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ØªØ¬Ø± ÙˆØ§Ù„Ø±Ù‡Ø§Ù†Ø§Øª */
        #ui-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(15px); }
        .royal-panel { background: linear-gradient(135deg, #1a0000, #000); border: 2px solid var(--gold); border-radius: 20px; padding: 25px; width: 90%; max-width: 500px; text-align: center; color: var(--ghost); box-shadow: 0 0 50px var(--blood); }
        
        .market-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .cat-card { background: #111; border: 1px solid #333; padding: 10px; border-radius: 15px; cursor: pointer; transition: 0.3s; }
        .cat-card:hover { border-color: var(--gold); transform: translateY(-5px); }
        .cat-card img { width: 50px; height: 50px; }
        
        .bet-box { background: var(--blood); color: #fff; padding: 10px; border-radius: 10px; margin: 15px 0; font-weight: bold; }
        
        .btn-entry { background: var(--gold); color: #000; width: 100%; padding: 15px; border-radius: 50px; border: none; font-size: 20px; font-weight: bold; cursor: pointer; box-shadow: 0 0 20px rgba(255,215,0,0.3); }

        /* HUD - Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø±Ø¹Ø¨ */
        #hud { position: fixed; top: 10px; width: 100%; padding: 0 20px; z-index: 1000; display: flex; justify-content: space-between; color: var(--gold); font-size: 18px; pointer-events: none; }
        .heart-bar { color: #ff0000; font-size: 25px; filter: drop-shadow(0 0 5px #ff0000); }

        canvas { display: block; filter: contrast(1.2) brightness(0.8); }
    </style>
</head>
<body>

<div id="hud">
    <div id="lives-container" class="heart-bar">â¤ï¸â¤ï¸â¤ï¸</div>
    <div>ğŸ’° ÙƒÙˆÙŠÙ†Ø²: <span id="coin-val">500</span></div>
</div>

<div id="ui-overlay">
    <div class="royal-panel">
        <h1 style="color:var(--gold); margin:0;">Ù‚ØµØ± Ø§Ù„Ù‡ÙŠÙ…Ø§Ù„Ø§ÙŠØ§ Ø§Ù„Ù…Ø³ÙƒÙˆÙ†</h1>
        <p style="font-size:14px; color:#888;">Ø§Ø¯ÙØ¹ 10 ÙƒÙˆÙŠÙ†Ø² Ù„ØªØ¯Ø®Ù„ Ø§Ù„Ù…Ø±Ø­Ù„Ø© ÙˆØªÙ†Ø§ÙØ³ Ø¹Ù„Ù‰ 100 ÙƒÙˆÙŠÙ†Ø²!</p>
        
        <div class="bet-box">Ø§Ù„Ù…ØªØµØ¯Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ: ØµÙ‚Ø± Ø§Ù„Ø¹Ø±Ø¨ (15,400 Ù†Ù‚Ø·Ø©)</div>

        <div class="market-grid">
            <div class="cat-card" onclick="selectCat('ghost', 0)">
                <img src="https://cdn-icons-png.flaticon.com/512/1864/1864514.png">
                <p>Ù‚Ø· Ø§Ù„Ø´Ø¨Ø­<br><small>Ù…Ø¬Ø§Ù†ÙŠ</small></p>
            </div>
            <div class="cat-card" onclick="selectCat('royal', 50)">
                <img src="https://cdn-icons-png.flaticon.com/512/616/616408.png">
                <p>Ø§Ù„Ù…Ù„Ùƒ Ø§Ù„Ø°Ù‡Ø¨ÙŠ<br><small>50 ÙƒÙˆÙŠÙ†Ø²</small></p>
            </div>
        </div>

        <button class="btn-entry" onclick="startAdventure()">Ø¯ÙØ¹ Ø§Ù„Ø±Ø³ÙˆÙ… ÙˆØ¯Ø®ÙˆÙ„ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø© ğŸšª</button>
    </div>
</div>

<script>
const cvs = document.getElementById('canvas') || document.createElement('canvas');
if(!document.getElementById('canvas')) document.body.appendChild(cvs);
const ctx = cvs.getContext('2d');

const imgs = {
    cat: new Image(), mon: new Image(), gold: new Image()
};
imgs.cat.src = 'https://cdn-icons-png.flaticon.com/512/616/616408.png';
imgs.mon.src = 'https://cdn-icons-png.flaticon.com/512/1211/1211053.png'; // ÙˆØ¬Ù‡ Ù…Ø±Ø¹Ø¨
imgs.gold.src = 'https://cdn-icons-png.flaticon.com/512/2489/2489756.png';

let state = { playing: false, score: 0, lives: 3, dist: 0, frame: 0, coins: 500 };
let player = { x: 0, y: 0, v: 0, g: 0.5, j: -10, w: 80, h: 80 };
let objects = { obs: [], gold: [] };

function resize() {
    cvs.width = window.innerWidth; cvs.height = window.innerHeight;
    player.x = cvs.width * 0.15;
}
window.onresize = resize; resize();

function startAdventure() {
    if(state.coins < 10) return alert("Ù„Ø§ ØªÙ…Ù„Ùƒ ÙƒÙˆÙŠÙ†Ø² ÙƒØ§ÙÙŠØ©!");
    state.coins -= 10;
    document.getElementById('coin-val').innerText = state.coins;
    state.playing = true; state.score = 0; state.lives = 3; state.dist = 0;
    objects = { obs: [], gold: [] };
    player.y = cvs.height/2;
    document.getElementById('ui-overlay').style.display = 'none';
    render();
}

function render() {
    if(!state.playing) return;
    state.frame++; state.dist += 3;

    // Ø±Ø³Ù… Ø§Ù„Ù‚ØµØ± Ø§Ù„Ù…Ø±Ø¹Ø¨
    ctx.fillStyle = '#050000'; ctx.fillRect(0,0,cvs.width, cvs.height);
    
    // Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø¨Ø±Ù‚ Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
    if(Math.random() > 0.98) { ctx.fillStyle = 'rgba(255,255,255,0.1)'; ctx.fillRect(0,0,cvs.width, cvs.height); }

    // Ø±Ø³Ù… Ø§Ù„Ù†ÙˆØ§ÙØ° ÙˆØ§Ù„Ø£Ø¹Ù…Ø¯Ø©
    ctx.fillStyle = '#1a0505';
    for(let i=0; i<5; i++) {
        let x = (i * 400) - (state.dist % 400);
        ctx.fillRect(x + 50, 100, 100, 200); // Ù†Ø§ÙØ°Ø©
    }

    // Ø§Ù„Ù‚Ø·Ø©
    player.v += player.g; player.y += player.v;
    ctx.shadowBlur = 15; ctx.shadowColor = "rgba(255,215,0,0.5)";
    ctx.drawImage(imgs.cat, player.x, player.y, player.w, player.h);
    ctx.shadowBlur = 0;

    // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙˆØ­ÙˆØ´ (Ø§Ù„ÙˆØ¬ÙˆÙ‡ Ø§Ù„Ù…Ø±Ø¹Ø¨Ø©)
    if(state.frame % 60 == 0) {
        objects.obs.push({x: cvs.width, y: Math.random()*(cvs.height-150), s: 90 + Math.random()*40});
    }
    objects.obs.forEach((o, i) => {
        o.x -= (9 + state.score/50);
        // Ø­Ø±ÙƒØ© "ØªØ°Ø¨Ø°Ø¨" Ù„Ù„ÙˆØ­Ø´ Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø±Ø¹Ø¨
        let shake = Math.sin(state.frame * 0.2) * 5;
        ctx.drawImage(imgs.mon, o.x, o.y + shake, o.s, o.s);
        
        // Ø§ØµØ·Ø¯Ø§Ù…
        if(player.x+20 < o.x+o.s-20 && player.x+player.w-20 > o.x+20 && player.y+20 < o.y+o.s-20 && player.y+player.h-20 > o.y+20) {
            state.lives--; 
            objects.obs.splice(i, 1);
            if(state.lives <= 0) gameOver();
        }
    });

    // Ø§Ù„Ø°Ù‡Ø¨ (Ø§Ù„ÙƒÙˆÙŠÙ†Ø²)
    if(state.frame % 80 == 0) objects.gold.push({x: cvs.width, y: Math.random()*cvs.height});
    objects.gold.forEach((g, i) => {
        g.x -= 7;
        ctx.drawImage(imgs.gold, g.x, g.y, 40, 40);
        if(Math.hypot(player.x+40-g.x, player.y+40-g.y) < 50) {
            state.score += 10; objects.gold.splice(i,1);
        }
    });

    // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø±Ø­Ù„Ø© (Ø®Ø· Ø§Ù„Ù†Ù‡Ø§ÙŠØ©)
    if(state.dist > 5000) winStage();

    document.getElementById('lives-container').innerText = "â¤ï¸".repeat(state.lives);
    requestAnimationFrame(render);
}

function gameOver() {
    state.playing = false;
    document.getElementById('ui-overlay').style.display = 'flex';
    document.querySelector('h1').innerText = "Ù„Ù‚Ø¯ Ø§Ù„ØªÙ‡Ù…Ùƒ Ø§Ù„Ø­Ø§Ø±Ø³!";
    document.querySelector('p').innerText = "Ø®Ø³Ø±Øª Ø±Ù‡Ø§Ù†Ùƒ.. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„ØªØ³ØªØ¹ÙŠØ¯ ÙƒØ±Ø§Ù…ØªÙƒ!";
}

function winStage() {
    state.playing = false;
    state.coins += 50; // Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„ÙÙˆØ²
    document.getElementById('ui-overlay').style.display = 'flex';
    document.querySelector('h1').innerText = "Ø¨Ø·Ù„ Ø§Ù„Ù‚ØµØ±!";
    document.querySelector('p').innerText = "Ø±Ø¨Ø­Øª 50 ÙƒÙˆÙŠÙ†Ø²! Ø£Ù†Øª Ø§Ù„Ø¢Ù† ØªÙ‚ØªØ±Ø¨ Ù…Ù† ØµØ¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ†Ø§ÙØ³ÙŠÙ†.";
}

// Ø§Ù„ØªØ­ÙƒÙ…
window.addEventListener('mousedown', () => { if(state.playing) player.v = player.j; });
window.addEventListener('touchstart', (e) => { if(state.playing) player.v = player.j; e.preventDefault(); });
</script>
</body>
</html>