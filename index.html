<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalaya: Cat Empire 2026</title>
    <style>
        :root { --gold: #f1c40f; --dark: #0a0a0a; }
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; touch-action: none; }
        
        /* ÙˆØ§Ø¬Ù‡Ø© HUD Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
        #hud { position: absolute; top: 10px; width: 100%; display: flex; justify-content: space-around; z-index: 10; color: white; pointer-events: none; }
        .stat { background: rgba(0,0,0,0.8); border: 2px solid var(--gold); padding: 5px 15px; border-radius: 20px; font-weight: bold; }

        /* Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; display: flex; align-items: center; justify-content: center; text-align: center; color: white; }
        .window { background: #1a1a1a; border: 3px solid var(--gold); padding: 30px; border-radius: 30px; width: 85%; max-width: 450px; }
        
        /* Ø§Ù„Ù…ØªØ¬Ø± */
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .item { background: #333; padding: 10px; border-radius: 15px; border: 1px solid #555; cursor: pointer; font-size: 13px; }
        .item:hover { border-color: var(--gold); background: #444; }

        button { padding: 12px 30px; font-size: 18px; cursor: pointer; border-radius: 50px; background: var(--gold); color: black; border: none; font-weight: bold; width: 100%; }
        #progress { position: fixed; bottom: 0; left: 0; height: 8px; background: var(--gold); width: 0%; transition: 0.1s; }
    </style>
</head>
<body>

<div id="hud">
    <div class="stat">ğŸ’° <span id="coins">520</span></div>
    <div class="stat">ğŸ° Ø§Ù„Ù…Ø±Ø­Ù„Ø© <span id="stage-num">1</span></div>
    <div class="stat">â¤ï¸ <span id="lives">â¤ï¸â¤ï¸â¤ï¸</span></div>
</div>

<div id="progress"></div>

<div id="menu" class="overlay">
    <div class="window">
        <h1 style="color:var(--gold)">Ù…ØªØ¬Ø± Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© ğŸ¾</h1>
        <p id="msg">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø¯Ù‡Ø§Ù„ÙŠØ² Ø§Ù„ØºØ¨Ø§Ø±</p>
        
        <div class="shop-grid">
            <div class="item" onclick="buy('life', 50)">â¤ï¸ Ø²ÙŠØ§Ø¯Ø© Ù‚Ù„Ø¨<br>50 ğŸ’°</div>
            <div class="item" onclick="buy('shield', 100)">ğŸ›¡ï¸ Ø¯Ø±Ø¹ Ø¨Ø±Ù‚ÙŠ<br>100 ğŸ’°</div>
            <div class="item" onclick="buy('speed', 200)">âš¡ Ø­Ø°Ø§Ø¡ Ø§Ù„Ø³Ø±Ø¹Ø©<br>200 ğŸ’°</div>
            <div class="item" onclick="buy('magnet', 300)">ğŸ§² Ù…ØºÙ†Ø§Ø·ÙŠØ³<br>300 ğŸ’°</div>
        </div>
        
        <button onclick="startGame()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¯Ù‡Ù„ÙŠØ² (10 ğŸ’°)</button>
    </div>
</div>

<canvas id="c"></canvas>

<script>
    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØ± (Ù†ÙØ³ Ø±ÙˆØ§Ø¨Ø· ÙƒÙˆØ¯Ùƒ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ø°ÙŠ ØªØ­Ø¨Ù‡)
    const imgLinks = {
        cat: 'https://img.icons8.com/color/96/cat--v1.png',
        wolf: 'https://img.icons8.com/color/150/wolf.png',
        coin: 'https://img.icons8.com/color/48/fish.png' // ÙƒÙˆÙŠÙ†Ø² Ø¨Ø´ÙƒÙ„ Ø³Ù…ÙƒØ© Ù‚Ø·Ø·!
    };
    const imgs = {};
    Object.keys(imgLinks).forEach(k => { imgs[k] = new Image(); imgs[k].src = imgLinks[k]; });

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ø¯Ù…Ø¬ ÙƒÙˆØ¯Ùƒ Ù…Ø¹ Ù†Ø¸Ø§Ù…Ù†Ø§)
    let user = { coins: 520, stage: 1, lives: 3, shield: false, xp: 0 };
    let p = { x: 80, y: 300, v: 0, s: 60 }; // Ø§Ù„Ù‚Ø·Ø©
    let obs = [], items = [];
    let dist = 1000, active = false;

    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.onresize = resize; resize();

    function buy(type, price) {
        if(user.coins >= price) {
            user.coins -= price;
            if(type === 'life') user.lives++;
            if(type === 'shield') user.shield = true;
            document.getElementById('coins').innerText = user.coins;
            alert("ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡! ğŸ¾");
        }
    }

    function startGame() {
        if(user.coins < 10) return alert("Ù„Ø§ ØªÙ…Ù„Ùƒ ÙƒÙˆÙŠÙ†Ø² ÙƒØ§ÙÙŠØ©!");
        user.coins -= 10;
        active = true; dist = 1000; p.y = canvas.height/2; p.v = 0;
        obs = []; items = [];
        document.getElementById('menu').style.display = 'none';
        loop();
    }

    function loop() {
        if(!active) return;

        // Ø®Ù„ÙÙŠØ© Ø¯Ù‡Ù„ÙŠØ² Ù…ØªØºÙŠØ±Ø© (ØªØºÙ…Ù‚ ÙƒÙ„Ù…Ø§ Ø²Ø§Ø¯Øª Ø§Ù„Ù…Ø±Ø­Ù„Ø©)
        ctx.fillStyle = `hsl(${200 + user.stage * 10}, 20%, 5%)`;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // --- ÙÙŠØ²ÙŠØ§Ø¡ Ø§Ù„Ù‚Ø·Ø© (Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø°ÙŠ Ø·Ù„Ø¨ØªÙ‡) ---
        p.v += 0.45; p.y += p.v;
        if(p.y > canvas.height - p.s) p.y = canvas.height - p.s;
        if(p.y < 0) p.y = 0;

        // Ø±Ø³Ù… Ø§Ù„Ù‚Ø·Ø© Ø¨ÙˆÙ‡Ø¬ (Aura)
        ctx.save();
        if(user.shield) { ctx.shadowBlur = 20; ctx.shadowColor = "cyan"; }
        ctx.drawImage(imgs.cat, p.x, p.y, p.s, p.s);
        ctx.restore();

        // --- ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø­ÙˆØ§Ø¬Ø² ÙˆØ§Ù„ÙˆØ­ÙˆØ´ ---
        if(Math.random() < 0.02 + (user.stage * 0.002)) {
            obs.push({ x: canvas.width, y: Math.random()*(canvas.height-100), s: 80, spd: 5 + user.stage });
        }

        obs.forEach((o, i) => {
            o.x -= o.spd;
            ctx.drawImage(imgs.wolf, o.x, o.y, o.s, o.s);
            
            // ØªØµØ§Ø¯Ù… (Ù†ÙØ³ Ù…Ù†Ø·Ù‚ ÙƒÙˆØ¯Ùƒ)
            if(p.x + 40 > o.x && p.x < o.x + o.s - 20 && p.y + 40 > o.y && p.y < o.y + o.s - 20) {
                if(user.shield) { user.shield = false; }
                else { user.lives--; }
                obs.splice(i, 1);
                if(user.lives <= 0) gameOver();
            }
        });

        // --- Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² (Ø§Ù„Ø³Ù…Ùƒ Ø§Ù„Ø°Ù‡Ø¨ÙŠ) ---
        if(Math.random() < 0.03) items.push({ x: canvas.width, y: Math.random()*canvas.height });
        items.forEach((f, i) => {
            f.x -= 5;
            ctx.drawImage(imgs.coin, f.x, f.y, 30, 30);
            if(Math.hypot(p.x - f.x, p.y - f.y) < 50) {
                user.coins += 15; items.splice(i, 1);
            }
        });

        // Ø§Ù„ØªÙ‚Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø±Ø­Ù„Ø©
        dist -= 2;
        document.getElementById('progress').style.width = (1 - (dist/1000))*100 + "%";
        document.getElementById('coins').innerText = user.coins;
        document.getElementById('lives').innerText = "â¤ï¸".repeat(user.lives);
        document.getElementById('stage-num').innerText = user.stage;

        if(dist <= 0) winStage();
        else requestAnimationFrame(loop);
    }

    function winStage() {
        active = false; user.stage++;
        document.getElementById('menu').style.display = 'flex';
        document.getElementById('msg').innerText = "Ø±Ø§Ø¦Ø¹! Ø§Ù†ØªÙ‚Ù„Øª Ù„Ù„Ù…Ø±Ø­Ù„Ø© " + user.stage;
    }

    function gameOver() {
        active = false; user.stage = 1; user.lives = 3;
        document.getElementById('menu').style.display = 'flex';
        document.getElementById('msg').innerText = "Ø£Ù…Ø³Ùƒ Ø¨Ùƒ Ø§Ù„ÙˆØ­Ø´! Ø¹Ø¯ Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©.";
    }

    // Ø§Ù„ØªØ­ÙƒÙ… (Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ ÙƒÙˆØ¯Ùƒ)
    const jump = () => { if(active) p.v = -9; };
    window.onmousedown = jump;
    window.ontouchstart = (e) => { e.preventDefault(); jump(); };

</script>
</body>
</html>